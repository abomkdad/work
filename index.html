<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAD System - Fully Editable</title>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        :root { --theme-gold: #D4AF37; --bg-gray: #f4f4f4; }
        @page { size: A4; margin: 15mm; } 
        body { margin: 0; padding: 0; background: var(--bg-gray); font-family: 'Assistant', sans-serif; }

        /* --- Admin Panel --- */
        #adminPanel {
            background: #2c3e50; color: white; padding: 20px;
            display: flex; flex-direction: column; gap: 15px;
            border-bottom: 5px solid var(--theme-gold);
        }
        .admin-row { display: flex; gap: 10px; flex-wrap: wrap; }
        .admin-input { flex: 1; padding: 10px; border-radius: 5px; border: none; }
        .btn-generate { 
            background: var(--theme-gold); color: black; padding: 10px 20px; 
            border: none; font-weight: bold; cursor: pointer; border-radius: 5px;
            font-size: 16px; margin-top: 10px;
        }

        /* --- Employee Panel --- */
        #employeePanel {
            position: fixed; bottom: 0; left: 0; right: 0;
            background: rgba(0,0,0,0.9); padding: 15px; color: white;
            z-index: 1000; text-align: center; display: none;
        }
        .upload-btn { background: #3498db; color: white; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin: 0 5px; display: inline-block; font-size: 14px; }
        .save-btn { background: #27ae60; color: white; padding: 10px 20px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; font-size: 16px; margin-left: 10px; }

        /* --- Contract Page --- */
        .page-container {
            width: 210mm; 
            min-height: 297mm; 
            background: white; 
            margin: 20px auto;
            padding: 20mm 25mm; 
            box-shadow: 0 0 15px rgba(0,0,0,0.1); 
            box-sizing: border-box;
            position: relative;
            height: auto; 
            overflow: visible;
        }

        /* --- Editable Behavior --- */
        /* Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ ÙŠØ¬Ø¹Ù„ Ø§Ù„Ù†ØµÙˆØµ Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„ Ø¨Ø¯ÙˆÙ† Ø¥Ø·Ø§Ø± Ù…Ø²Ø¹Ø¬ */
        [contenteditable="true"] { outline: none; }
        [contenteditable="true"]:hover { background-color: rgba(255, 255, 0, 0.05); cursor: text; }
        [contenteditable="true"]:focus { background-color: rgba(255, 255, 0, 0.1); }

        /* Elements */
        .logo-img { max-width: 180px; display: block; margin: 0 auto 10px auto; cursor: pointer; }
        h1 { text-align: center; text-decoration: underline; font-size: 24px; margin-bottom: 5px; }
        .sub-header { text-align: center; font-size: 14px; margin-bottom: 30px; color: #555; }
        
        .section-header { 
            font-weight: bold; text-decoration: underline; 
            margin-top: 25px; margin-bottom: 10px; font-size: 16px; 
            background: #f9f9f9; padding: 5px; border-right: 4px solid var(--theme-gold);
        }
        
        .contract-text { font-size: 14px; line-height: 1.6; text-align: justify; }
        .contract-text ol { padding-right: 20px; margin: 0; }
        .contract-text li { margin-bottom: 8px; }

        .data-field { font-weight: bold; color: #000; padding: 0 5px; border-bottom: 1px dotted #000; }
        
        /* Signature Area */
        .signatures-area {
            margin-top: 50px; 
            display: flex; justify-content: space-between; align-items: flex-end;
            page-break-inside: avoid; 
        }
        
        #sigCanvas { border: 1px dashed #ccc; background: #fff; width: 100%; height: 100px; touch-action: none; }
        .stamp-img { position: absolute; width: 140px; bottom: 80px; left: 15%; mix-blend-mode: multiply; pointer-events: none; }

        /* ID Preview */
        .id-preview-container { margin-top: 50px; page-break-before: always; display: none; text-align: center; }
        .id-img { max-width: 80%; border: 1px solid #ddd; margin: 10px auto; display: block; }

        /* Footer (For Print) */
        .footer-print { display: none; }

        @media print {
            #adminPanel, #employeePanel, .btn-clear { display: none !important; }
            body { background: white; }
            .page-container { margin: 0; box-shadow: none; width: 100%; padding-bottom: 20mm; }
            .id-preview-container { display: block !important; }
            [contenteditable="true"]:hover { background-color: transparent; } /* Ø¥Ø®ÙØ§Ø¡ Ø®Ù„ÙÙŠØ© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø¹Ù†Ø¯ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© */
            
            .footer-print {
                display: block; position: fixed; bottom: 0; left: 0; right: 0; height: 40px;
                background: white; border-top: 2px solid var(--theme-gold);
                text-align: center; padding-top: 10px; font-size: 11px; color: #555; z-index: 999;
            }
        }
    </style>
</head>
<body>

    <div id="adminPanel">
        <h3>ğŸ‘®â€â™‚ï¸ ×× ×”×œ - ×™×¦×™×¨×ª ×§×™×©×•×¨ ×œ×¢×•×‘×“ (× ×™×ª×Ÿ ×œ×¢×¨×•×š ××ª ×”×˜×§×¡×˜ ×œ××˜×” ×™×“× ×™×ª)</h3>
        <div class="admin-row">
            <input type="text" id="adminName" class="admin-input" placeholder="×©× ×”×¢×•×‘×“">
            <input type="text" id="adminID" class="admin-input" placeholder="×ª.×–">
            <input type="date" id="adminDate" class="admin-input">
        </div>
        <div class="admin-row">
            <input type="number" id="adminSalary" class="admin-input" placeholder="×©×›×¨ ×œ×©×¢×”" value="35">
            <input type="text" id="adminScope" class="admin-input" placeholder="×”×™×§×£ ××©×¨×”" value="××©×¨×” ××œ××” / ××©××¨×•×ª">
        </div>
        <button class="btn-generate" onclick="generateLink()">ğŸ”— ×”×¢×ª×§ ×§×™×©×•×¨ ×œ×•×•××˜×¡××¤</button>
        <div id="linkOutput" style="background:white; color:black; padding:10px; display:none; margin-top:10px; word-break: break-all;"></div>
    </div>

    <div class="page-container">
        
        <img src="logo.jpg" class="logo-img" onerror="this.style.display='none'">
        
        <div id="editableContent" contenteditable="true" spellcheck="false">
            
            <h1>×”×¡×›× ×¢×‘×•×“×” ××™×©×™ ××™×•×—×“</h1>
            <div class="sub-header">× ×¢×¨×š ×•× ×—×ª× ×‘×—×“×¨×” ×‘×™×•× <span id="dispDate" class="data-field">__/__/____</span></div>

            <div class="contract-text">
                <p><strong>×‘×™×Ÿ: ×—×‘×¨×ª ×××“ ×¤×¨×¤×™×•× ×‘×¢"× (MAD PARFUMEUR)</strong>, ×—.×¤ 515456093<br>
                ××¨×—×•×‘ ×”× ×©×™× 1, ×—×“×¨×” (×œ×”×œ×Ÿ: "<strong>×”×—×‘×¨×”</strong>" ××• "<strong>×”××¢×¡×™×§</strong>") <u>××¦×“ ××—×“</u>;</p>
                
                <p><strong>×œ×‘×™×Ÿ:</strong> <span id="dispName" class="data-field">__________</span> ×ª.×– <span id="dispID" class="data-field">__________</span><br>
                (×œ×”×œ×Ÿ: "<strong>×”×¢×•×‘×“</strong>") <u>××¦×“ ×©× ×™</u>.</p>

                <p><strong>×”×•××™×œ</strong> ×•×”×—×‘×¨×” ×¢×•×¡×§×ª ×‘×©×™×•×•×§ ×•××›×™×¨×” ×©×œ ××•×¦×¨×™ ×‘×™×©×•× ×•×§×•×¡××˜×™×§×” ("×”××•×¦×¨×™×");<br>
                <strong>×•×”×•××™×œ</strong> ×•×”×—×‘×¨×” ××¢×•× ×™×™× ×ª ×œ×”×¢×¡×™×§ ××ª ×”×¢×•×‘×“ ×‘×ª×¤×§×™×“ ×”××¤×•×¨×˜ ×œ×”×œ×Ÿ;<br>
                <strong>×•×”×•××™×œ</strong> ×•×”×¢×•×‘×“ ××¢×•× ×™×™×Ÿ ×œ×¢×‘×•×“ ×‘×—×‘×¨×” ×•××¦×”×™×¨ ×›×™ ×”×•× ×‘×¢×œ ×”×›×™×©×•×¨×™× ×”××ª××™××™×;</p>

                <p style="text-align: center; font-weight: bold;">×œ×¤×™×›×š ×”×•×¡×›×, ×”×•×¦×”×¨ ×•×”×•×ª× ×” ×‘×™×Ÿ ×”×¦×“×“×™× ×›×“×œ×§××Ÿ:</p>

                <div class="section-header">1. ×›×œ×œ×™ ×•×ª×§×•×¤×ª ×”×¢×¡×§×”</div>
                <ol>
                    <li>×”××‘×•× ×œ×”×¡×›× ×–×” ××”×•×•×” ×—×œ×§ ×‘×œ×ª×™ × ×¤×¨×“ ××× ×•.</li>
                    <li>×ª×§×•×¤×ª ×”×¢×¡×§×ª×• ×©×œ ×”×¢×•×‘×“ ×ª×—×œ ×‘×™×•× ×”×—×ª×™××” ×¢×œ ×”×¡×›× ×–×”, ×œ×ª×§×•×¤×” ×‘×œ×ª×™ ×§×¦×•×‘×”.</li>
                    <li><strong>×ª×§×•×¤×ª × ×™×¡×™×•×Ÿ:</strong> 3 ×”×—×•×“×©×™× ×”×¨××©×•× ×™× ×œ×¢×‘×•×“×ª×• ×™×™×—×©×‘×• ×›×ª×§×•×¤×ª × ×™×¡×™×•×Ÿ. ×”×—×‘×¨×” ×¨×©××™×ª ×œ×”××¨×™×š ×ª×§×•×¤×” ×–×• ×‘-3 ×—×•×“×©×™× × ×•×¡×¤×™× ×¢×œ ×¤×™ ×©×™×§×•×œ ×“×¢×ª×”. ×‘××”×œ×š ×ª×§×•×¤×” ×–×•, ×ª×‘×—×Ÿ ×”×—×‘×¨×” ××ª ×”×ª×××ª×• ×©×œ ×”×¢×•×‘×“ ×œ×ª×¤×§×™×“.</li>
                </ol>

                <div class="section-header">2. ×ª×¤×§×™×“ ×”×¢×•×‘×“ ×•×¡××›×•×™×•×ª×™×•</div>
                <ol>
                    <li>×”×¢×•×‘×“ ×™×•×¢×¡×§ ×‘×ª×¤×§×™×“: <strong>×™×•×¢×¥ ××›×™×¨×•×ª / ××•×›×¨×Ÿ</strong> ×‘×¡× ×™×¤×™ ×”×¨×©×ª.</li>
                    <li>×‘××¡×’×¨×ª ×ª×¤×§×™×“×•, ×™×”×™×” ×”×¢×•×‘×“ ××—×¨××™ ×¢×œ:
                        <ul>
                            <li>××ª×Ÿ ×©×™×¨×•×ª ×•××›×™×¨×” ×œ×œ×§×•×—×•×ª ×”×—×‘×¨×”.</li>
                            <li>× ×™×”×•×œ ×§×•×¤×”, ×¡×œ×™×§×ª ××©×¨××™ ×•×˜×™×¤×•×œ ×‘××–×•×× ×™× ×‘××—×¨×™×•×ª ××œ××”.</li>
                            <li>×¡×™×“×•×¨ ×¡×—×•×¨×”, ×§×‘×œ×ª ×¡×—×•×¨×” ××¡×¤×§×™× ×•×¡×™××•×Ÿ ××—×™×¨×™×.</li>
                            <li>×©××™×¨×” ×¢×œ × ×™×§×™×•×Ÿ ×•×¡×“×¨ ×‘×¡× ×™×£ ×•×‘×¡×‘×™×‘×ª×•.</li>
                            <li>×‘×™×¦×•×¢ ×¡×¤×™×¨×•×ª ××œ××™ ×ª×§×•×¤×ª×™×•×ª.</li>
                        </ul>
                    </li>
                    <li>×”×¢×•×‘×“ ××ª×—×™×™×‘ ×œ××œ× ××ª ×ª×¤×§×™×“×• ×‘×™×•×©×¨, ×‘××¡×™×¨×•×ª, ×‘××™×•×× ×•×ª ×•×‘×¨××” ××§×¦×•×¢×™×ª ×’×‘×•×”×”, ×•×œ×¦×™×™×ª ×œ×”×•×¨××•×ª ×”×××•× ×” ×¢×œ×™×•.</li>
                </ol>

                <div class="section-header">3. ×©×¢×•×ª ×¢×‘×•×“×” ×•×”×™×§×£ ××©×¨×”</div>
                <ol>
                    <li>×”×¢×•×‘×“ ×™×¢×‘×•×“ ×‘×”×™×§×£ ××©×¨×” ×©×œ: <span id="dispScope" class="data-field">_____</span>.</li>
                    <li>×©×¢×•×ª ×”×¢×‘×•×“×” ×™×§×‘×¢×• ×‘×¡×™×“×•×¨ ×¢×‘×•×“×” ×©×‘×•×¢×™ ×©×™×¤×•×¨×¡× ×¢"×™ ×× ×”×œ ×”×¡× ×™×£/×”××–×•×¨.</li>
                    <li>×”×¢×•×‘×“ × ×“×¨×© ×œ×”×’×™×¢ ×œ××©××¨×ª ×›-15 ×“×§×•×ª ×œ×¤× ×™ ×ª×—×™×œ×ª×” ×œ×¦×•×¨×š ×”×ª××¨×’× ×•×ª ×•×—×¤×™×¤×” (×–××Ÿ ×–×” ××™× ×• × ×—×©×‘ ×›×©×¢×•×ª ×¢×‘×•×“×” ××œ× ×× ×”×•×¡×›× ××—×¨×ª).</li>
                    <li><strong>×©×¢×•×ª × ×•×¡×¤×•×ª:</strong> ×”×¢×•×‘×“ ×™×‘×¦×¢ ×©×¢×•×ª × ×•×¡×¤×•×ª ××š ×•×¨×§ ×¢×œ ×¤×™ ×“×¨×™×©×” ××¤×•×¨×©×ª ×•×‘××™×©×•×¨ ××¨××© ×©×œ ×”××¢×¡×™×§. ×ª×©×œ×•× ×‘×’×™×Ÿ ×©×¢×•×ª × ×•×¡×¤×•×ª ×™×‘×•×¦×¢ ×¢×œ ×¤×™ ×—×•×§.</li>
                </ol>

                <div class="section-header">4. ×©×›×¨ ×•×ª× ××™× × ×œ×•×•×™×</div>
                <ol>
                    <li>×‘×ª××•×¨×” ×œ×¢×‘×•×“×ª×•, ×™×©×œ× ×”××¢×¡×™×§ ×œ×¢×•×‘×“ ×©×›×¨ ×©×¢×ª×™ ×‘×¡×š: <strong><span id="dispSalary" class="data-field">35</span> â‚ª ×œ×©×¢×”</strong> (×‘×¨×•×˜×•).</li>
                    <li>×”×©×›×¨ ×™×©×•×œ× ×œ× ×™××•×—×¨ ××”-9 ×œ×›×œ ×—×•×“×© ×§×œ× ×“×¨×™ ×‘×’×™×Ÿ ×”×—×•×“×© ×”×—×•×œ×£.</li>
                    <li><strong>×”×•×¦××•×ª × ×¡×™×¢×”:</strong> ×”×¢×•×‘×“ ×–×›××™ ×œ×”×—×–×¨ ×”×•×¦××•×ª × ×¡×™×¢×” ×¢×“ ×œ×ª×§×¨×” ×”×§×‘×•×¢×” ×‘×¦×• ×”×”×¨×—×‘×” (×—×•×¤×©×™ ×—×•×“×©×™ ×–×•×œ).</li>
                    <li><strong>×“××™ ×”×‘×¨××”:</strong> ×™×©×•×œ××• ×œ×¢×•×‘×“ ×œ××—×¨ ×”×©×œ××ª ×©× ×ª ×¢×‘×•×“×” ××œ××”, ×‘×”×ª×× ×œ×¦×• ×”×”×¨×—×‘×” ×‘××©×§.</li>
                    <li><strong>×‘×™×’×•×“:</strong> ×”×¢×•×‘×“ × ×“×¨×© ×œ×”×•×¤×™×¢ ×œ×¢×‘×•×“×” ×‘×œ×‘×•×© ×”×•×œ× ×•×™×™×¦×•×’×™. ×‘××™×“×” ×•×ª×¡×•×¤×§ ×—×•×œ×¦×ª ××“×™×, ×—×•×‘×” ×œ×œ×‘×•×© ××•×ª×”.</li>
                </ol>

                <div class="section-header">5. ×ª× ××™× ×¡×•×¦×™××œ×™×™× (×¤× ×¡×™×” ×•×¤×™×¦×•×™×™×)</div>
                <ol>
                    <li>×”×¢×•×‘×“ ×™×‘×•×˜×— ×‘×‘×™×˜×•×— ×¤× ×¡×™×•× ×™ ××§×™×£ ×‘×”×ª×× ×œ×¦×• ×”×”×¨×—×‘×” ×œ×‘×™×˜×•×— ×¤× ×¡×™×•× ×™ ×‘××©×§.</li>
                    <li>×”×¤×¨×©×•×ª ×”××¢×¡×™×§ ×•×”×¢×•×‘×“ ×™×”×™×• ×›×“×œ×§××Ÿ (× ×›×•×Ÿ ×œ-2026):
                        <ul>
                            <li>×ª×’××•×œ×™ ××¢×¡×™×§: 6.5%</li>
                            <li>×ª×’××•×œ×™ ×¢×•×‘×“: 6%</li>
                            <li>×¤×™×¦×•×™×™×: 6% (××• 8.33% ×‘×”×¡×›××” × ×¤×¨×“×ª)</li>
                        </ul>
                    </li>
                    <li>×–×›××•×ª ×œ×”×¤×¨×©×•×ª ×ª×—×œ ×œ××—×¨ 6 ×—×•×“×©×™ ×¢×‘×•×“×”, ××œ× ×× ×œ×¢×•×‘×“ ×™×© ×‘×™×˜×•×— ×¤× ×¡×™×•× ×™ ×¤×¢×™×œ ×§×•×“×, ××– ×ª×—×œ ×”×–×›××•×ª ×œ××—×¨ 3 ×—×•×“×©×™× (×¨×˜×¨×•××§×˜×™×‘×™×ª) ××• ××ª×—×™×œ×ª ×”×©× ×”, ×”××•×§×“× ××‘×™× ×™×”×.</li>
                </ol>

                <div class="section-header">6. ×—×•×¤×©×” ×©× ×ª×™×ª ×•××—×œ×”</div>
                <ol>
                    <li>×”×¢×•×‘×“ ×–×›××™ ×œ×™××™ ×—×•×¤×©×” ×©× ×ª×™×ª ×‘×ª×©×œ×•× ×‘×”×ª×× ×œ×—×•×§ ×—×•×¤×©×” ×©× ×ª×™×ª, ×•×‘×”×ª×× ×œ×•×•×ª×§ ×©×¦×‘×¨.</li>
                    <li>×™××™ ××—×œ×” ×™×©×•×œ××• ×‘×›×¤×•×£ ×œ×”××¦××ª ××™×©×•×¨ ×¨×¤×•××™ ×›×“×™×Ÿ, ×•×‘×”×ª×× ×œ×—×•×§ ×“××™ ××—×œ×” (×™×•× ×¨××©×•×Ÿ 0%, ×™×•× ×©× ×™ ×•×©×œ×™×©×™ 50%, ×™×•× ×¨×‘×™×¢×™ ×•××™×œ×š 100%).</li>
                </ol>

                <div class="section-header">7. ×©××™×¨×ª ×¡×•×“×™×•×ª ×•××™ ×ª×—×¨×•×ª</div>
                <ol>
                    <li>×”×¢×•×‘×“ ××¦×”×™×¨ ×›×™ ×™×“×•×¢ ×œ×• ×©×‘×ª×•×§×£ ×ª×¤×§×™×“×• ×”×•× ×™×™×—×©×£ ×œ××™×“×¢ ×¨×’×™×©, ×¡×•×“×•×ª ××¡×—×¨×™×™×, ×¨×©×™××•×ª ×œ×§×•×—×•×ª, × ×”×œ×™ ×¢×‘×•×“×” ×•××—×™×¨×•× ×™× ×©×œ ×”×—×‘×¨×”.</li>
                    <li>×”×¢×•×‘×“ ××ª×—×™×™×‘ ×œ×©××•×¨ ×¢×œ ×¡×•×“×™×•×ª ××•×—×œ×˜×ª ×•×œ× ×œ×’×œ×•×ª, ×œ×”×¢×‘×™×¨ ××• ×œ×¢×©×•×ª ×©×™××•×© ×‘××™×“×¢ ×–×”, ×”×Ÿ ×‘×ª×§×•×¤×ª ×¢×‘×•×“×ª×• ×•×”×Ÿ ×œ××—×¨×™×”, ××œ× ×œ×¦×•×¨×›×™ ×¢×‘×•×“×ª×• ×‘×—×‘×¨×” ×‘×œ×‘×“.</li>
                    <li>×”×¢×•×‘×“ ××ª×—×™×™×‘ ×©×œ× ×œ×¢×‘×•×“ ××¦×œ ××ª×—×¨×™× ×™×©×™×¨×™× ×©×œ ×”×—×‘×¨×” ×‘××”×œ×š ×ª×§×•×¤×ª ×¢×‘×•×“×ª×•, ××œ× ×‘××™×©×•×¨ ××¨××© ×•×‘×›×ª×‘.</li>
                </ol>

                <div class="section-header">8. ×©××™×¨×” ×¢×œ ×¨×›×•×© ×”×—×‘×¨×”</div>
                <ol>
                    <li>×”×¢×•×‘×“ ××ª×—×™×™×‘ ×œ×©××•×¨ ×¢×œ ×¨×›×•×© ×”×—×‘×¨×”, ×”×¦×™×•×“ ×•×”××œ××™ ×©× ××¡×¨×• ×œ×—×–×§×ª×•.</li>
                    <li>×—×œ ××™×¡×•×¨ ××•×—×œ×˜ ×œ×”×•×¦×™× ×¨×›×•×© ××• ×¡×—×•×¨×” ××©×˜×— ×”×¡× ×™×£ ×œ×œ× ××™×©×•×¨ ×•×ª×™×¢×•×“ ××ª××™×. ×›×œ ×—×•×¡×¨ ×‘×œ×ª×™ ××•×¡×‘×¨ ×‘×§×•×¤×” ××• ×‘××œ××™ ×©×‘××—×¨×™×•×ª ×”×¢×•×‘×“ ×™×™×‘×“×§ ×‘×—×•××¨×”.</li>
                </ol>

                <div class="section-header">9. ×¡×™×•× ×™×—×¡×™ ×¢×‘×•×“×”</div>
                <ol>
                    <li>×›×œ ×¦×“ ×¨×©××™ ×œ×¡×™×™× ××ª ×™×—×¡×™ ×”×¢×‘×•×“×” ×‘××ª×Ÿ ×”×•×“×¢×” ××•×§×“××ª ×‘×›×ª×‘ ×œ×¦×“ ×”×©× ×™, ×‘×”×ª×× ×œ×—×•×§ ×”×•×“×¢×” ××•×§×“××ª ×œ×¤×™×˜×•×¨×™× ×•×œ×”×ª×¤×˜×¨×•×ª (×™×•× ×¢×‘×•×¨ ×›×œ ×—×•×“×© ×‘×—×¦×™ ×”×©× ×” ×”×¨××©×•× ×”, ×•×›×•').</li>
                    <li>×”××¢×¡×™×§ ×¨×©××™ ×œ×¡×™×™× ××ª ×¢×‘×•×“×ª ×”×¢×•×‘×“ <strong>×œ××œ×ª×¨ ×•×œ×œ× ×”×•×“×¢×” ××•×§×“××ª</strong> (×•×©×œ×™×œ×ª ×¤×™×¦×•×™×™× ×‘×—×œ×§× ××• ×‘××œ×•××) ×‘××§×¨×™× ×—××•×¨×™× ×›×’×•×Ÿ: ×’× ×™×‘×”, ××¢×™×œ×” ×‘×××•×Ÿ, ××œ×™××•×ª, ×”×˜×¨×“×”, ××• ×’×¨×™××ª × ×–×§ ××›×•×•×Ÿ ×œ×¨×›×•×© ×”×—×‘×¨×”.</li>
                    <li>×¢× ×¡×™×•× ×¢×‘×•×“×ª×•, ××ª×—×™×™×‘ ×”×¢×•×‘×“ ×œ×”×—×–×™×¨ ×œ×—×‘×¨×” ×›×œ ×¦×™×•×“, ××¤×ª×—, ×›×¨×˜×™×¡ ××’× ×˜×™ ××• ××¡××š ×©×‘×¨×©×•×ª×•.</li>
                </ol>

                <br><br>
                <p><strong>×•×œ×¨××™×” ×‘××• ×”×¦×“×“×™× ×¢×œ ×”×—×ª×•×:</strong></p>
                <div class="signatures-area">
                    <div style="text-align: center; position: relative; width: 40%;">
                        <img src="signther.jpg" class="stamp-img">
                        <div style="margin-bottom: 30px;"><strong>×”××¢×¡×™×§ (MAD PARFUMEUR)</strong></div>
                        <div style="border-top: 1px solid black; padding-top: 5px;">×—×ª×™××” ×•×—×•×ª××ª</div>
                    </div>

                    <div style="text-align: center; width: 40%;">
                        <div style="margin-bottom: 5px; color:red; font-size:12px;">×—×ª×™××ª ×”×¢×•×‘×“ × ×“×¨×©×ª ×›××Ÿ:</div>
                        <canvas id="sigCanvas"></canvas>
                        <button class="btn-clear" onclick="clearSig()" style="font-size:10px; margin-top:2px;">× ×§×” ×—×ª×™××”</button>
                        <div style="border-top: 1px solid black; margin-top: 5px;">×©× ×”×¢×•×‘×“ ×•×—×ª×™××ª×•</div>
                    </div>
                </div>
            </div>
        </div>

        <div id="idContainer" class="id-preview-container">
            <h1>× ×¡×¤×— ×': ×¦×™×œ×•× ×ª×¢×•×“×ª ×–×”×•×ª ×•×¡×¤×—</h1>
            <p>×”××¡××›×™× ×”×‘××™× ×¦×•×¨×¤×• ×¢"×™ ×”×¢×•×‘×“ ×›×—×œ×§ ×‘×œ×ª×™ × ×¤×¨×“ ××”×¡×›× ×”×¢×‘×•×“×”:</p>
            <img id="viewIDFront" class="id-img">
            <img id="viewIDBack" class="id-img">
        </div>

        <div class="footer-print">
            <strong>MAD PARFUMEUR LTD</strong> | 515456093 | www.madperfume.co.il | ×¢××•×“ ××ª×•×š ×”×¡×›× ×¢×‘×•×“×”
        </div>

    </div>

    <div id="employeePanel">
        <div style="margin-bottom: 5px; font-weight: bold;">×—×•×‘×” ×œ×¦×¨×£ ×¦×™×œ×•× ×ª.×– ×•×¡×¤×— ×œ×¤× ×™ ×”×—×ª×™××”:</div>
        
        <label class="upload-btn">
            <i class="fas fa-id-card"></i> ×¦×™×œ×•× ×ª×¢×•×“×”
            <input type="file" hidden accept="image/*" onchange="previewID(this, 'viewIDFront')">
        </label>
        
        <label class="upload-btn">
            <i class="fas fa-file-alt"></i> ×¦×™×œ×•× ×¡×¤×—
            <input type="file" hidden accept="image/*" onchange="previewID(this, 'viewIDBack')">
        </label>

        <button class="save-btn" onclick="validateAndSave()">
            <i class="fas fa-file-signature"></i> ×©××•×¨ ×•×©×œ×— (PDF)
        </button>
    </div>

    <script>
        // --- LOGIC ---
        window.onload = function() {
            const urlParams = new URLSearchParams(window.location.search);
            document.getElementById('adminDate').valueAsDate = new Date();

            if (urlParams.has('data')) {
                // Employee Mode
                document.getElementById('adminPanel').style.display = 'none';
                document.getElementById('employeePanel').style.display = 'block';
                // Disable content editing for employee to prevent tampering? 
                // Or leave enabled? User asked for editable texts. 
                // Let's leave it enabled but fill data.
                
                try {
                    const str = decodeURIComponent(escape(atob(urlParams.get('data'))));
                    const data = JSON.parse(str);
                    
                    if(document.getElementById('dispName')) document.getElementById('dispName').innerText = data.name;
                    if(document.getElementById('dispID')) document.getElementById('dispID').innerText = data.id;
                    if(document.getElementById('dispDate')) document.getElementById('dispDate').innerText = data.date;
                    if(document.getElementById('dispSalary')) document.getElementById('dispSalary').innerText = data.salary;
                    if(document.getElementById('dispScope')) document.getElementById('dispScope').innerText = data.scope;
                } catch(e) {
                    console.error("Error parsing data", e);
                }
            } else {
                // Admin Mode
                document.getElementById('dispDate').innerText = new Date().toLocaleDateString('he-IL');
            }
        };

        function generateLink() {
            const data = {
                name: document.getElementById('adminName').value,
                id: document.getElementById('adminID').value,
                date: document.getElementById('adminDate').value.split('-').reverse().join('/'),
                salary: document.getElementById('adminSalary').value,
                scope: document.getElementById('adminScope').value
            };

            if(!data.name || !data.id) { alert("×™×© ×œ××œ× ××ª ×›×œ ×”×©×“×•×ª"); return; }

            const jsonStr = JSON.stringify(data);
            const encoded = btoa(unescape(encodeURIComponent(jsonStr)));
            const link = window.location.href.split('?')[0] + '?data=' + encoded;
            
            const output = document.getElementById('linkOutput');
            output.style.display = 'block';
            output.innerHTML = `<strong>×©×œ×— ×§×™×©×•×¨ ×–×” ×œ×¢×•×‘×“:</strong><br><a href="${link}">${link}</a>`;
            navigator.clipboard.writeText(link).then(() => alert("×”×§×™×©×•×¨ ×”×•×¢×ª×§!"));
        }

        // Image Preview
        let idFront = false;
        function previewID(input, imgId) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById(imgId).src = e.target.result;
                    document.getElementById('idContainer').style.display = 'block';
                    if(imgId === 'viewIDFront') idFront = true;
                }
                reader.readAsDataURL(input.files[0]);
            }
        }

        // Signature Canvas
        const canvas = document.getElementById('sigCanvas');
        const ctx = canvas.getContext('2d');
        let painting = false, sigFilled = false;

        function startPos(e) { painting = true; draw(e); }
        function endPos() { painting = false; ctx.beginPath(); }
        function draw(e) {
            if (!painting) return;
            e.preventDefault();
            const rect = canvas.getBoundingClientRect();
            const x = (e.clientX || e.touches[0].clientX) - rect.left;
            const y = (e.clientY || e.touches[0].clientY) - rect.top;
            ctx.lineWidth = 2; ctx.lineCap = 'round';
            ctx.lineTo(x, y); ctx.stroke(); ctx.beginPath(); ctx.moveTo(x, y);
            sigFilled = true;
        }

        ['mousedown', 'touchstart'].forEach(e => canvas.addEventListener(e, startPos));
        ['mouseup', 'touchend'].forEach(e => canvas.addEventListener(e, endPos));
        ['mousemove', 'touchmove'].forEach(e => canvas.addEventListener(e, draw));

        function clearSig() { ctx.clearRect(0,0,canvas.width,canvas.height); sigFilled = false; }

        function validateAndSave() {
            if (!sigFilled) { alert("×—×•×‘×” ×œ×—×ª×•× ×‘×ª×™×‘×”!"); return; }
            if (!idFront) { if(!confirm("×œ× ×¦×™×¨×¤×ª ×ª×¢×•×“×ª ×–×”×•×ª. ×œ×”××©×™×š?")) return; }
            window.print();
        }
    </script>
</body>
</html>
